"0","n=dim(spambase)[1]"
"0","set.seed(12345) "
"0","id=sample(1:n, floor(n*0.5)) "
"0","train=spambase[id,]  "
"0","test=spambase[-id,]"
"0","data <- train"
"0","newdata <- test"
"0","knearest=function(data,k,newdata) {"
"0","  "
"0","  n1=dim(data)[1]"
"0","  n2=dim(newdata)[1]"
"0","  p=dim(data)[2]"
"0","  Prob=numeric(n2)"
"0","  X=as.matrix(data[,-p])"
"0","  Y=as.matrix(newdata[,-p])"
"0","  "
"0","  X_hat=X/matrix(sqrt(rowSums(X^2)), nrow=n1, ncol=p-1)"
"0","  Y_hat=Y/matrix(sqrt(rowSums(Y^2)), nrow=n2, ncol=p-1)"
"0","  "
"0","  C <- X_hat %*% t(Y_hat)"
"0","  "
"0","  D <- 1 - C"
"0","  "
"0","  for (i in 1:n2 ){"
"0","    "
"0","    D_i <- as.data.frame(cbind(value=D[,i],spam=data[,p]))"
"0","    N_i <- D_i[order(D_i$value),]"
"0","    Prob[i] <- sum(N_i[1:k,2]) / k"
"0","  }"
"0","  return(Prob)"
"0","}"
"0","# Assignment 1 part 3"
"0","prob <- knearest(data,5,newdata)"
"0","Y_pred <- ifelse(prob > 0.5,1,0)"
"0","col_num <- ncol(data)"
"0","c_mat <- table(data[,col_num],Y_pred)"
"0","# misclassification rate"
"0","mis_class_kkn <- sum(c_mat[row(c_mat) != col(c_mat)])/ sum(c_mat)"
"0","# Assignnment 1 part 4"
"0","prob <- knearest(data,1,newdata)"
"0","col_num <- ncol(data)"
"0","c_mat <- table(data[,col_num],prob > 0.5)"
"0","# misclassification rate"
"0","mis_class_1 <- sum(c_mat[row(c_mat) != col(c_mat)])/ sum(c_mat)"
"0","# Assignment 1 part 5"
"0","library(kknn)"
"0","kkn <- kknn(Spam~.,data,newdata,k=5)"
"0","probability <- kkn$fitted.values"
"0","Y_pred <- ifelse(probability > 0.5,1,0)"
"0","col_num <- ncol(data)"
"0","# Confusion matrix"
"0","c_mat <- table(data[,col_num],Y_pred)"
"0","# misclassification rate"
"0","mis_class_kknn <- sum(c_mat[row(c_mat) != col(c_mat)])/ sum(c_mat)"
